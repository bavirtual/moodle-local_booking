/**
 * This module handles session booking and logentry operations
 * including CRUD and UI events.
 *
 * @module     local_booking/booking_actions
 * @author     Mustafa Hajjar (mustafa.hajjar)
 * @copyright  BAVirtual.co.uk Â© 2024
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_booking/booking_actions",["jquery","core/pending","core/notification","local_booking/booking_view_manager","local_booking/repository","local_booking/modal_actions","local_booking/events","local_booking/selectors"],(function($,Pending,Notification,ViewManager,Repository,ModalActions,BookingEvents,Selectors){return{gotoFeedback:function(root,e){let courseId,exerciseId,userId,Source=root.find(Selectors.logentryitem);0!==Source.length?(courseId=Source.data("courseId"),exerciseId=Source.data("exerciseId"),userId=Source.data("userId")):(Source=$(e.target).closest(Selectors.regions.session),courseId=$(Selectors.wrappers.bookingwrapper).data("courseid"),exerciseId=Source.data("exerciseId"),userId=Source.data("studentId")),$("body").trigger(BookingEvents.gotoFeedback,[exerciseId]),location.href=M.cfg.wwwroot+"/local/booking/assign.php?courseid="+courseId+"&exeid="+exerciseId+"&rownum=0&userid="+userId+"&passed=1"},cancelBooking:function(root){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const pendingPromise=new Pending("local_booking/registerCancelBookingForm"),bookingRoot=$(Selectors.wrappers.bookingwrapper);ViewManager.startLoading(root),ViewManager.startLoading(bookingRoot),ViewManager.renderCancelBookingConfirmation(e),ViewManager.stopLoading(root),ViewManager.stopLoading(bookingRoot),pendingPromise.resolve()},processNoShow:function(root){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const pendingPromise=new Pending("local_booking/registerNoShowWarningConfirmation"),body=$("body"),bookingRoot=$(Selectors.wrappers.bookingwrapper),noshowButton=$(e.target).closest(Selectors.regions.noshowbutton),noshows=noshowButton.data("noshows"),bookingId=noshowButton.data("bookingid");ModalActions.showWarning("commentnoshow"+noshows,"commentnoshowtitle",{},{fromComponent:!0,buttonType:"yesno"}),body.on(BookingEvents.responseYES,(function(){return ViewManager.startLoading(root),ViewManager.startLoading(bookingRoot),Repository.cancelBooking(bookingId,null,!0).then((function(response){response.result&&$("body").trigger(BookingEvents.noshowProcessed)})).always((function(){Notification.fetchNotifications(),ViewManager.stopLoading(root),ViewManager.stopLoading(bookingRoot)})).fail(Notification.exception)})),pendingPromise.resolve()}}}));

//# sourceMappingURL=booking_actions.min.js.map