define ("local_booking/booking",["jquery","core/str","core/pending","local_booking/view_manager","local_booking/booking_actions","local_booking/events","local_booking/selectors"],function(a,b,c,d,f,g,h){var i={PROGRESSION_WRAPPER:".progressionwrapper",CANCEL_BUTTON:"[data-region='cancel-button']",SESSION_ENTRY:"[data-region='session-entry']"},j=function(b,c){var e=a("body");e.on(g.canceled,function(){d.refreshProgressionContent(b);d.refreshMyBookingsContent(b)});e.on(g.created,function(){d.refreshProgressionContent(b)});e.on(g.updated,function(){d.refreshProgressionContent(b)});e.on(g.deleted,function(){d.refreshProgressionContent(b)});if("undefined"!==c){f.registerEditListeners(b,c)}},k=function(g){var k=f.registerLogentryFormModal(g),l=a(i.PROGRESSION_WRAPPER).data("context-id"),m=a(i.PROGRESSION_WRAPPER).data("courseid");j(g,k);if(l){g.on("click",i.SESSION_ENTRY,function(b){var e=a(this).attr("data-session-date"),f=a(this).attr("data-student-id"),g=a(this).attr("data-exercise-id"),i=a(this).attr("data-logentry-id");if(0==i){k.then(function(a){a.setContextId(l);a.setCourseId(m);a.setStudentId(f);a.setExerciseId(g);a.setLogentryId(i);a.setSessionDate(e);a.show()}).fail(Notification.exception);b.preventDefault()}else{var j=null,n=null,o=b.target,p=new c("local_booking/view_manager:logentryLink:click");if(o.matches(h.actions.viewEvent)){j=o}else{j=o.closest(h.actions.viewEvent)}if(j){n=j.dataset.logentryId}else{n=o.querySelector(h.actions.viewEvent).dataset.logentryId}if(n){b.preventDefault();b.stopPropagation();d.renderLogentrySummaryModal(n,m,f).then(p.resolve).catch()}else{p.resolve()}}})}g.on("click",i.CANCEL_BUTTON,function(a){b.get_string("cancellationcomment","local_booking").then(function(b){var c=prompt(b);if(null!==c){f.cancelBooking(g,a,c)}}).catch(Notification.exception)})};return{init:function init(b){b=a(b);k(b)}}});
//# sourceMappingURL=booking.min.js.map
