{"version":3,"file":"slot_actions.min.js","sources":["../src/slot_actions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Contain the logic for the quick add or update event modal.\n *\n * @module     local_booking/slot_actions\n * @author     Mustafa Hajjar (mustafahajjar@gmail.com)\n * @copyright  BAVirtual.co.uk Â© 2021\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'jquery',\n    'core/notification',\n    'local_booking/repository',\n    'local_booking/calendar_view_manager',\n    'local_booking/modal_actions',\n    ],\n    function(\n        $,\n        Notification,\n        Repository,\n        CalendarViewManager,\n        ModalActions,\n    ) {\n\n    var SELECTORS = {\n        CALENDAR_WRAPPER: '[class=calendarwrapper]',\n        SLOTS_TABLE: '[data-region=\"slots-week\"]',\n        SLOT_DAY: '[data-region=\"day\"]',\n        SAVE_BUTTON: '[data-region=\"save-button\"]',\n        PASTE_BUTTON: \"[data-region='paste-button']\",\n        BOOK_BUTTON: \"[data-region='book-button']\",\n        DAY_TIME_SLOT: \"[data-action='day-time-slot']\",\n        LOADING_ICON_CONTAINER: '[data-region=\"loading-icon-container\"]',\n    };\n\n    var Slots = [];\n    var BookedSlot;\n    var SlotIndexes = [];\n    var postActive = false;\n\n    /**\n     * Save marked availability posts.\n     *\n     * @method saveWeekSlots\n     * @param {object} root The calendar root element\n     * @return {object} The create modal promise\n     */\n    function saveWeekSlots(root) {\n\n        CalendarViewManager.startLoading(root);\n\n        // Get year and week\n        const course = root.find(SELECTORS.CALENDAR_WRAPPER).data('courseid');\n        const year = root.find(SELECTORS.CALENDAR_WRAPPER).data('year');\n        const week = root.find(SELECTORS.CALENDAR_WRAPPER).data('week');\n        const minslotperiod = root.find(SELECTORS.CALENDAR_WRAPPER).data('minslotperiod');\n        const unixtshr = 3600;\n        const lastminute = 60;\n\n\n        // Get marked availability slots\n        getUISlots(root);\n\n        // Evaluate each slot to ensure it is a minimum of 2hrs if minimum slots is required (minslotperiod!=0)\n        let minSlotPeriodMet = true;\n        $.map( Slots, function(val) {\n            if ((val.endtime - val.starttime + lastminute) < (minslotperiod * unixtshr) && minslotperiod != 0) {\n                minSlotPeriodMet = false;\n            }\n        });\n\n        if (minSlotPeriodMet) {\n            let serverCall = null;\n            if (Slots.length != 0) {\n                serverCall = Repository.saveSlots(Slots, course, year, week);\n            } else {\n                serverCall = Repository.clearSlots(course, year, week);\n            }\n\n            // Send a request to the server to clear slots.\n            return serverCall\n                .then(function(response) {\n                    if (response.validationerror) {\n                        // eslint-disable-next-line no-alert\n                        alert('Errors encountered: Unable to process availability posting action!');\n                    }\n                    return;\n                }\n                )\n                .always(function() {\n                    Notification.fetchNotifications();\n                    return CalendarViewManager.stopLoading(root);\n                }\n                )\n                .fail(Notification.exception);\n        } else {\n            // Show warning message\n            CalendarViewManager.stopLoading(root);\n            ModalActions.showWarning('minslotperiodwarning', minslotperiod);\n        }\n    }\n\n    /**\n     * Save marked booking posts.\n     *\n     * @method saveBookedSlot\n     * @param {object} root The calendar root element\n     * @return {object} The create modal promise\n     */\n    function saveBookedSlot(root) {\n\n        CalendarViewManager.startLoading(root);\n\n        // Get exercise id and the user id from the URL\n        const course = root.find(SELECTORS.CALENDAR_WRAPPER).data('courseid');\n        const exercise = root.find(SELECTORS.CALENDAR_WRAPPER).data('exercise-id');\n        const studentid = root.find(SELECTORS.CALENDAR_WRAPPER).data('student-id');\n\n        // Get marked availability slots\n        getUISlots(root, 'book');\n\n        // Check if the instructor has conflicting bookings\n        return Repository.isConflictingBookings(studentid, BookedSlot)\n            .then(function(response) {\n                if (response.validationerror) {\n                    // eslint-disable-next-line no-alert\n                    alert('Errors encountered: Unable to check conflicting bookings!');\n                } else {\n                    // Check if there are no conflicting messages\n                    if (response.result) {\n                        // eslint-disable-next-line no-alert\n                        alert(response.warnings[0].message);\n                    } else {\n                        // No conflicting bookings, save the booking.\n                        // eslint-disable-next-line promise/no-nesting\n                        return Repository.saveBookedSlot(BookedSlot, course, exercise, studentid)\n                            .then(function(response) {\n                                if (response.validationerror) {\n                                    // eslint-disable-next-line no-alert\n                                    alert('Errors encountered: Unable to save slot!');\n                                } else {\n                                    // Redirect to bookings view\n                                    location.href = M.cfg.wwwroot + '/local/booking/view.php?courseid=' + course;\n                                }\n                                return;\n                            }\n                            )\n                            .always(function() {\n                                CalendarViewManager.stopLoading(root);\n                                return;\n                            }\n                            )\n                            .fail(Notification.exception);\n                    }\n                    return !response.result;\n                }\n                return false;\n            }\n            )\n            .always(function() {\n                CalendarViewManager.stopLoading(root);\n            })\n            .fail(Notification.exception);\n        }\n\n    /**\n     * Update Slots & BookedSlots with marked availability\n     * posts in the calendar view.\n     *\n     * @method getSlots\n     * @param {object} root     The calendar root element\n     * @param {String} action   The action for display view/book\n     */\n    function getUISlots(root, action) {\n\n        const slottype = action == 'book' ? 'slot-booked' : 'slot-marked';\n        const year = root.find(SELECTORS.CALENDAR_WRAPPER).data('year');\n        const week = root.find(SELECTORS.CALENDAR_WRAPPER).data('week');\n        const minute59 = 3540; // 59 minutes end of slot but befor next hour\n\n        const tableid = root.find(SELECTORS.SLOTS_TABLE).attr('id');\n        const head = $('#' + tableid + ' th');\n        const colCount = document.getElementById(tableid).rows[0].cells.length;\n        let colOffset;\n\n        Slots.length = 0;\n        // Get column index for the start of the week\n        head.each(function() {\n            if ($(this).data('region') == 'slot-week-day') {\n                colOffset = head.index(this) + 1;\n                return false;\n            }\n        });\n\n        // Get all slots for this week from the UI table\n        for (let i = colOffset; i <= colCount; i++) {\n            // Get slots for the current day\n            const dayHour = $('#' + tableid + ' td:nth-child(' + i + ')').map(function() {\n                return [[$(this).data(slottype), $(this).data('slot-timestamp')]];\n            }).get();\n\n            // Get each slot in the day (start and end times)\n            let aSlot = {};\n\n            // Check each day (column) and record marked slot start-end times\n            dayHour.forEach((hourSlot, index) => {\n                let isLastElement = index == dayHour.length - 1;\n\n                // Check if the slot is marked to record start or end time in marked sequence\n                if (hourSlot[0]) {\n                    if (Object.keys(aSlot).length === 0 && aSlot.constructor === Object) {\n                        aSlot.starttime = hourSlot[1];\n                        aSlot.endtime = hourSlot[1] + minute59;\n                    } else {\n                        aSlot.endtime = hourSlot[1] + minute59;\n                    }\n\n                // Add the slot if it has start and end, and this slot is empty => slot sequence ended\n                } else if (!(Object.keys(aSlot).length === 0 && aSlot.constructor === Object)) {\n                    aSlot = addSlot(aSlot, slottype, week, year);\n                }\n\n                // Add slot if it ends at the end of the day\n                if (isLastElement && !(Object.keys(aSlot).length === 0 && aSlot.constructor === Object)) {\n                    aSlot = addSlot(aSlot, slottype, week, year);\n                }\n            });\n        }\n    }\n\n    /**\n     * Adds a slot to local object array (Slots).\n     *\n     * @method addSlot\n     * @param {object} aSlot The slot to be add to the local object array\n     * @param {string} slottype The slot type availability post vs booked\n     * @param {int} week The week of the year\n     * @param {int} year The year\n     * @return {object} empty object\n     */\n     function addSlot(aSlot, slottype, week = 0, year = 0) {\n        if (slottype == 'slot-marked') {\n            Slots.push(aSlot);\n        } else if (slottype == 'slot-booked') {\n            aSlot.week = week;\n            aSlot.year = year;\n            BookedSlot = aSlot;\n        }\n        return {};\n    }\n\n    /**\n     * Update the indexes array tracking copied table indexes\n     * editing existing events.\n     *\n     * @param {object} root The calendar root element\n     * @method copySlots\n     */\n    function copySlots(root) {\n        SlotIndexes.length = 0;\n\n        $(SELECTORS.SLOT_DAY).each((idx, el) => {\n            if ($(el).data('slot-marked')) {\n                SlotIndexes.push([el.closest('tr').rowIndex, el.cellIndex]);\n            }\n        });\n\n        setPasteState(root);\n\n        return;\n    }\n\n    /**\n     * Paste slots by seting the cells from\n     * SlotIndexes (copied cells) to the calendar\n     *\n     * @method pasteSlots\n     * @param {object} root The calendar root element\n     */\n    function pasteSlots(root) {\n        const table = document.getElementById(root.find(SELECTORS.SLOTS_TABLE).attr('id'));\n        SlotIndexes.forEach((idx) => {\n            let slot = table.rows[idx[0]].cells[idx[1]];\n            $(slot).data('slot-marked', 1);\n            $(slot).addClass('slot-selected', 1);\n        });\n        setSaveButtonState(root, 'post');\n\n        return;\n     }\n\n    /**\n     * Clear slots for a user per course in week and year\n     * given they are not otherwsie booked\n     *\n     * @method clearWeekSlots\n     * @param {object} root The week calendar root element\n     */\n    function clearWeekSlots(root) {\n        $('td').filter(function() {\n            if ($(this).data('slot-booked') == 0) {\n                $(this).data('slot-marked', 0);\n                $(this).removeClass('slot-selected');\n            }\n            return true;\n        });\n        setSaveButtonState(root, 'post', true);\n        return;\n    }\n\n    /**\n     * Set the cells from the copied SlotIndexes to the current table\n     *\n     * @method setPasteState\n     * @param {object} root The week calendar root element\n     */\n    function setPasteState(root) {\n        if (SlotIndexes.length > 0) {\n            root.find(SELECTORS.PASTE_BUTTON).addClass('slot-button-blue').removeClass('slot-button-gray');\n        } else {\n            root.find(SELECTORS.PASTE_BUTTON).addClass('slot-button-gray').removeClass('slot-button-blue');\n        }\n\n        return;\n     }\n\n    /**\n     * Set the save buttons state to enabled/disabled based\n     * on user calendar time slot selection (cells) in\n     * the week calendar\n     *\n     * @method setSaveButtonState\n     * @param {object} root      The calendar root element\n     * @param {string} action    The action behind the view\n     * @param {bool} forceenable Enable save button\n     */\n    function setSaveButtonState(root, action, forceenable) {\n        // Get marked availability slots\n        getUISlots(root, action);\n\n        const enabled = 'slot-button-blue';\n        const disabled = 'slot-button-gray';\n        const SaveButton = root.find(action == 'book' ? SELECTORS.BOOK_BUTTON : SELECTORS.SAVE_BUTTON);\n\n        let state = forceenable ||\n                (action == 'book' && BookedSlot !== undefined && BookedSlot.length !== 0) ||\n                (action == 'post' && Slots !== undefined && Slots.length !== 0);\n\n        SaveButton.addClass(state ? enabled : disabled).removeClass(!state ? enabled : disabled);\n        SaveButton.prop('disabled', !state);\n\n        return;\n     }\n\n    /**\n     * Set the cells from the CopiedSlotsIndexes to the current table\n     *\n     * @method setSlot\n     * @param {object} cell     The copied cell\n     * @param {String} action   The action mode: book|post\n     */\n    function setSlot(cell, action) {\n        const slotaction = action == 'book' ? 'slot-booked' : 'slot-marked';\n        const slotactionclass = action == 'book' ? 'slot-booked' : 'slot-selected';\n\n        if (!$(cell).data(slotaction)) {\n            $(cell).addClass(slotactionclass);\n        } else {\n            $(cell).removeClass(slotactionclass);\n        }\n        $(cell).data(slotaction, !$(cell).data(slotaction));\n\n        return;\n    }\n\n    /**\n     * Set cells selected and save buttons state\n     *\n     * @method setPosting\n     * @param {bool} state  The posting state\n     */\n    function setPosting(state) {\n        postActive = state;\n    }\n\n    /**\n     * Set cells selected and save buttons state\n     *\n     * @method postSlots\n     * @param {object} root     The calendar root element\n     * @param {String} action   The action behind the active view\n     * @param {object} target   The target event object (cell)\n     * @param {String} overridePost The override flag for posting state\n     */\n    function postSlots(root, action, target, overridePost = false) {\n        // Change marked state\n        if (typeof target !== 'undefined' && (postActive || overridePost)) {\n            if (!target.is(SELECTORS.DAY_TIME_SLOT) && action !== 'all' && action !== '') {\n                setSlot(target, action);\n                setSaveButtonState(root, action);\n            }\n        }\n\n        return;\n    }\n\n    return {\n        saveWeekSlots: saveWeekSlots,\n        saveBookedSlot: saveBookedSlot,\n        clearWeekSlots: clearWeekSlots,\n        pasteSlots: pasteSlots,\n        setPasteState: setPasteState,\n        setSaveButtonState: setSaveButtonState,\n        copySlots: copySlots,\n        postSlots: postSlots,\n        setPosting: setPosting,\n        Slots: Slots,\n        SlotIndexes: SlotIndexes\n    };\n});"],"names":["define","$","Notification","Repository","CalendarViewManager","ModalActions","BookedSlot","SELECTORS","Slots","SlotIndexes","postActive","getUISlots","root","action","slottype","year","find","data","week","tableid","attr","head","colCount","document","getElementById","rows","cells","length","colOffset","each","this","index","i","dayHour","map","get","aSlot","forEach","hourSlot","isLastElement","Object","keys","constructor","starttime","endtime","addSlot","arguments","undefined","push","setPasteState","addClass","removeClass","setSaveButtonState","forceenable","SaveButton","state","prop","saveWeekSlots","startLoading","course","minslotperiod","minSlotPeriodMet","val","serverCall","saveSlots","clearSlots","then","response","validationerror","alert","always","fetchNotifications","stopLoading","fail","exception","showWarning","saveBookedSlot","exercise","studentid","isConflictingBookings","result","warnings","message","location","href","M","cfg","wwwroot","clearWeekSlots","filter","pasteSlots","table","idx","slot","copySlots","el","closest","rowIndex","cellIndex","postSlots","target","is","cell","slotaction","slotactionclass","setSlot","setPosting"],"mappings":"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"}