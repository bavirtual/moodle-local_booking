{"version":3,"sources":["../src/calendar_view.js"],"names":["define","$","Notification","Selectors","BookingEvents","ViewManager","LogbookActions","registerEventListeners","root","type","body","reloadFunction","charAt","toUpperCase","slice","on","created","deleted","updated","courseSelector","selectElement","courseId","val","then","find","window","history","pushState","fail","exception","filterChanged","e","data","daysWithEvent","eventType","hidden","addClass","removeClass","eventFormPromise","registerLogentryFormModal","registerEditListeners","init"],"mappings":"AAuBAA,OAAM,+BAAC,CACC,QADD,CAEC,mBAFD,CAGC,yBAHD,CAIC,sBAJD,CAKC,4BALD,CAMC,+BAND,CAAD,CAQF,SACIC,CADJ,CAEIC,CAFJ,CAGIC,CAHJ,CAIIC,CAJJ,CAKIC,CALJ,CAMIC,CANJ,CAOE,CAEE,GAAIC,CAAAA,CAAsB,CAAG,SAASC,CAAT,CAAeC,CAAf,CAAqB,IAC1CC,CAAAA,CAAI,CAAGT,CAAC,CAAC,MAAD,CADkC,CAG1CU,CAAc,CAAG,gBAAkBF,CAAI,CAACG,MAAL,CAAY,CAAZ,EAAeC,WAAf,EAAlB,CAAiDJ,CAAI,CAACK,KAAL,CAAW,CAAX,CAHxB,CAK9CJ,CAAI,CAACK,EAAL,CAAQX,CAAa,CAACY,OAAtB,CAA+B,UAAW,CACtCX,CAAW,CAACM,CAAD,CAAX,CAA4BH,CAA5B,CACH,CAFD,EAGAE,CAAI,CAACK,EAAL,CAAQX,CAAa,CAACa,OAAtB,CAA+B,UAAW,CACtCZ,CAAW,CAACM,CAAD,CAAX,CAA4BH,CAA5B,CACH,CAFD,EAGAE,CAAI,CAACK,EAAL,CAAQX,CAAa,CAACc,OAAtB,CAA+B,UAAW,CACtCb,CAAW,CAACM,CAAD,CAAX,CAA4BH,CAA5B,CACH,CAFD,EAIAA,CAAI,CAACO,EAAL,CAAQ,QAAR,CAAkBZ,CAAS,CAACgB,cAA5B,CAA4C,UAAW,IAC/CC,CAAAA,CAAa,CAAGnB,CAAC,CAAC,IAAD,CAD8B,CAE/CoB,CAAQ,CAAGD,CAAa,CAACE,GAAd,EAFoC,CAGnDjB,CAAW,CAACM,CAAD,CAAX,CAA4BH,CAA5B,CAAkCa,CAAlC,CAA4C,IAA5C,EACKE,IADL,CACU,UAAW,CAEb,MAAOf,CAAAA,CAAI,CAACgB,IAAL,CAAUrB,CAAS,CAACgB,cAApB,EAAoCG,GAApC,CAAwCD,CAAxC,CACV,CAJL,EAKKE,IALL,CAKU,UAAW,CACbE,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB,EAAzB,CAA6B,EAA7B,CAAiC,WAAaN,CAA9C,CAGH,CATL,EAUKO,IAVL,CAUU1B,CAAY,CAAC2B,SAVvB,CAWH,CAdD,EAgBAnB,CAAI,CAACK,EAAL,CAAQX,CAAa,CAAC0B,aAAtB,CAAqC,SAASC,CAAT,CAAYC,CAAZ,CAAkB,CACnD,GAAIC,CAAAA,CAAa,CAAGzB,CAAI,CAACgB,IAAL,CAAUrB,CAAS,CAAC+B,SAAV,CAAoBF,CAAI,CAACvB,IAAzB,CAAV,CAApB,CACA,GAAI,IAAAuB,CAAI,CAACG,MAAT,CAAyB,CACrBF,CAAa,CAACG,QAAd,CAAuB,QAAvB,CACH,CAFD,IAEO,CACHH,CAAa,CAACI,WAAd,CAA0B,QAA1B,CACH,CACJ,CAPD,EASA,GAAIC,CAAAA,CAAgB,CAAGhC,CAAc,CAACiC,yBAAf,CAAyC/B,CAAzC,CAAvB,CACAF,CAAc,CAACkC,qBAAf,CAAqChC,CAArC,CAA2C8B,CAA3C,CACH,CA1CD,CA4CA,MAAO,CACHG,IAAI,CAAE,cAASjC,CAAT,CAAeC,CAAf,CAAqB,CACvBD,CAAI,CAAGP,CAAC,CAACO,CAAD,CAAR,CAEAH,CAAW,CAACoC,IAAZ,CAAiBjC,CAAjB,CAAuBC,CAAvB,EACAF,CAAsB,CAACC,CAAD,CAAOC,CAAP,CACzB,CANE,CAQV,CArEC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module is responsible for handle calendar day and upcoming view.\n *\n * @module     local_booking/calendar_view\n * @author     Mustafa Hajjar (mustafahajjar@gmail.com)\n * @copyright  BAVirtual.co.uk Â© 2021\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n        'jquery',\n        'core/notification',\n        'local_booking/selectors',\n        'local_booking/events',\n        'local_booking/view_manager',\n        'local_booking/logbook_actions'\n    ],\n    function(\n        $,\n        Notification,\n        Selectors,\n        BookingEvents,\n        ViewManager,\n        LogbookActions\n    ) {\n\n        var registerEventListeners = function(root, type) {\n            var body = $('body');\n\n            var reloadFunction = 'reloadCurrent' + type.charAt(0).toUpperCase() + type.slice(1);\n\n            body.on(BookingEvents.created, function() {\n                ViewManager[reloadFunction](root);\n            });\n            body.on(BookingEvents.deleted, function() {\n                ViewManager[reloadFunction](root);\n            });\n            body.on(BookingEvents.updated, function() {\n                ViewManager[reloadFunction](root);\n            });\n\n            root.on('change', Selectors.courseSelector, function() {\n                var selectElement = $(this);\n                var courseId = selectElement.val();\n                ViewManager[reloadFunction](root, courseId, null)\n                    .then(function() {\n                        // We need to get the selector again because the content has changed.\n                        return root.find(Selectors.courseSelector).val(courseId);\n                    })\n                    .then(function() {\n                        window.history.pushState({}, '', '?course=' + courseId);\n\n                        return;\n                    })\n                    .fail(Notification.exception);\n            });\n\n            body.on(BookingEvents.filterChanged, function(e, data) {\n                var daysWithEvent = root.find(Selectors.eventType[data.type]);\n                if (data.hidden == true) {\n                    daysWithEvent.addClass('hidden');\n                } else {\n                    daysWithEvent.removeClass('hidden');\n                }\n            });\n\n            var eventFormPromise = LogbookActions.registerLogentryFormModal(root);\n            LogbookActions.registerEditListeners(root, eventFormPromise);\n        };\n\n        return {\n            init: function(root, type) {\n                root = $(root);\n\n                ViewManager.init(root, type);\n                registerEventListeners(root, type);\n            }\n        };\n    });\n"],"file":"calendar_view.min.js"}