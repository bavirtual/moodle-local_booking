{"version":3,"sources":["../src/calendar.js"],"names":["define","$","CalendarViewManager","SlotActions","CalendarSelectors","SELECTORS","ROOT","DAY","SAVE_BUTTON","BOOK_BUTTON","COPY_BUTTON","PASTE_BUTTON","CLEAR_BUTTON","LOADING_ICON_CONTAINER","NEW_EVENT_BUTTON","DAY_CONTENT","LOADING_ICON","VIEW_DAY_LINK","CALENDAR_WEEK_WRAPPER","TODAY","registerEventListeners","root","action","data","on","saveWeekSlots","saveBookedSlot","copySlots","pasteSlots","clearWeekSlots","contextId","e","target","is","setSlot","setBookState","preventDefault","loadingIconContainer","find","containers","loadingIcon","addClass","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module is the highest level module for the calendar. It is\n * responsible for initialising all of the components required for\n * the calendar to run. It also coordinates the interaction between\n * components by listening for and responding to different events\n * triggered within the calendar UI.\n *\n *  Improvised from core_calendar.\n *\n * @module     local_booking/calendar\n * @author     Mustafa Hajjar (mustafahajjar@gmail.com)\n * @copyright  BAVirtual.co.uk Â© 2021\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n            'jquery',\n            'local_booking/view_manager',\n            'local_booking/slot_actions',\n            'core_calendar/selectors',\n        ],\n        function(\n            $,\n            CalendarViewManager,\n            SlotActions,\n            CalendarSelectors,\n        ) {\n\n    var SELECTORS = {\n        ROOT: \"[data-region='calendar']\",\n        DAY: \"[data-region='day']\",\n        SAVE_BUTTON: \"[data-region='save-button']\",\n        BOOK_BUTTON: \"[data-region='book-button']\",\n        COPY_BUTTON: \"[data-region='copy-button']\",\n        PASTE_BUTTON: \"[data-region='paste-button']\",\n        CLEAR_BUTTON: \"[data-region='clear-button']\",\n        LOADING_ICON_CONTAINER: '[data-region=\"loading-icon-container\"]',\n        NEW_EVENT_BUTTON: \"[data-action='new-event-button']\",\n        DAY_CONTENT: \"[data-region='day-content']\",\n        LOADING_ICON: '.loading-icon',\n        VIEW_DAY_LINK: \"[data-action='view-day-link']\",\n        CALENDAR_WEEK_WRAPPER: \".calendarwrapper\",\n        TODAY: '.today',\n    };\n\n    /**\n     * Register event listeners for the module.\n     *\n     * @param {object} root The calendar root element\n     */\n    var registerEventListeners = function(root) {\n        // Get action type of the current week view or booking\n        const action = $(SELECTORS.CALENDAR_WEEK_WRAPPER).data('action');\n\n        // Listen the click on the Save button.\n        root.on('click', SELECTORS.SAVE_BUTTON, function() {\n            SlotActions.saveWeekSlots(root);\n        });\n\n        // Listen the click on the Save Booking button.\n        root.on('click', SELECTORS.BOOK_BUTTON, function() {\n            SlotActions.saveBookedSlot(root);\n        });\n\n        // Listen the click on the Copy button.\n        root.on('click', SELECTORS.COPY_BUTTON, function() {\n            SlotActions.copySlots(root);\n        });\n\n        // Listen the click on the Copy button.\n        root.on('click', SELECTORS.PASTE_BUTTON, function() {\n            SlotActions.pasteSlots(root);\n        });\n\n        // Listen the click on the Clear button.\n        root.on('click', SELECTORS.CLEAR_BUTTON, function() {\n            SlotActions.clearWeekSlots();\n        });\n\n        // Listen to click on the clickable slot areas/cells\n        var contextId = $(SELECTORS.CALENDAR_WEEK_WRAPPER).data('context-id');\n        if (contextId) {\n            // Bind click events to week calendar days.\n            root.on('click', SELECTORS.DAY, function(e) {\n                var target = $(e.target);\n                // Change marked state\n                if (typeof target !== 'undefined') {\n                    if (!target.is(SELECTORS.VIEW_DAY_LINK) && action !== 'all') {\n                        SlotActions.setSlot(this, root, action);\n\n                        // Set active status of booking button\n                        if (action == 'book') {\n                            SlotActions.setBookState(root, action);\n                        }\n                    }\n                }\n\n                e.preventDefault();\n            });\n        }\n\n        // Remove loading\n        const loadingIconContainer = root.find(CalendarSelectors.containers.loadingIcon);\n        loadingIconContainer.addClass('hidden');\n\n    };\n\n    return {\n        init: function(root) {\n            root = $(root);\n            CalendarViewManager.init(root);\n            registerEventListeners(root);\n        }\n    };\n});\n"],"file":"calendar.min.js"}