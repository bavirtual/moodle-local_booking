{"version":3,"sources":["../src/repository.js"],"names":["getCalendarWeekData","year","week","time","courseId","categoryId","action","view","studentId","exerciseId","Ajax","call","methodname","args","courseid","categoryid","studentid","exerciseid","getBookingsData","filter","getExerciseName","saveBookedSlot","bookedslot","cancelBooking","bookingId","comment","noshow","bookingid","saveSlots","weekSlots","course","slots","clearSlots","submitCreateUpdateLogentryForm","formArgs","formData","formargs","formdata","getPilotLogbook","userId","userid","getLogentryById","logentryId","logentryid","deleteLogentry","findPirep","pirep","updateSuspendedStatus","status","updateGroup","group","ismember","updateUserPreferences","preference","value","updateProfileComment"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A javascript module to handle calendar ajax actions.\n *\n * @module     local_booking/repository\n * @author     Mustafa Hajjar (mustafahajjar@gmail.com)\n * @copyright  BAVirtual.co.uk Â© 2021\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Ajax from 'core/ajax';\n\n/**\n * Get calendar data for the month view.\n *\n * @method getCalendarWeekData\n * @param {number} year Year\n * @param {number} week Week\n * @param {number} time Timestamp\n * @param {number} courseId The course id.\n * @param {number} categoryId The category id.\n * @param {string} action The action type.\n * @param {string} view The view type user/all.\n * @param {number} studentId The id of the associated user.\n * @param {number} exerciseId The exercise id for the booked session.\n * @return {promise} Resolved with the month view data.\n */\n export const getCalendarWeekData = (year, week, time, courseId, categoryId, action, view, studentId, exerciseId) => {\n    const request = {\n        methodname: 'local_booking_get_weekly_view',\n        args: {\n            year,\n            week,\n            time,\n            courseid: courseId,\n            categoryid: categoryId,\n            action: action,\n            view: view,\n            studentid: studentId,\n            exerciseid: exerciseId,\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Get sesison booking, my bookings, and my students data to view.\n *\n * @method getBookingsData\n * @param {number} courseId The course id.\n * @param {string} filter   The filter to show students, inactive (including graduates), suspended, and default to active.\n * @return {promise} Resolved with the month view data.\n */\n export const getBookingsData = (courseId, filter) => {\n    const request = {\n        methodname: 'local_booking_get_bookings_view',\n        args: {\n            courseid: courseId,\n            filter: filter,\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Get sesison booking, my bookings, and my students data to view.\n *\n * @method getExerciseName\n * @param {number} courseId   The course id.\n * @param {number} exerciseId The exercise id.\n * @return {promise} Resolved with the month view data.\n */\n export const getExerciseName = (courseId, exerciseId) => {\n    const request = {\n        methodname: 'local_booking_get_exercise_name',\n        args: {\n            courseid: courseId,\n            exerciseid: exerciseId,\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Send booked slots to the server for persistence\n *\n * @param {array} bookedslot    The array of booked slots\n * @param {int} courseId        The course id of the booking\n * @param {int} exerciseId      The exercise id of the associated course\n * @param {int} studentId       The id of the associated user\n * @param {int} slotId          The id of the slot if exists != 0\n * @return {promise}\n */\n export const saveBookedSlot = (bookedslot, courseId, exerciseId, studentId) => {\n    const request = {\n        methodname: 'local_booking_save_booking',\n        args: {\n            bookedslot: bookedslot,\n            courseid: courseId,\n            exerciseid: exerciseId,\n            studentid: studentId,\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Cancel a sepcific booking for a student.\n *\n * @param {int} bookingId   The booking id to cancel\n * @param {string} comment  The booking id to cancel\n * @param {bool} noshow     Whether the cancellation is a no-show or instructor initiated\n * @return {promise}\n */\n export const cancelBooking = (bookingId, comment, noshow) => {\n    const request = {\n        methodname: 'local_booking_cancel_booking',\n        args: {\n            bookingid: bookingId,\n            comment: comment,\n            noshow: noshow,\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Send marked availability posts (time slots)\n * to the server to be persisted\n *\n * @param {string} weekSlots The URL encoded values from the form\n * @param {int} course The id of the associated course\n * @param {int} year The id of the event to update\n * @param {int} week A timestamp for some time during the target day\n * @return {promise}\n */\n export const saveSlots = (weekSlots, course, year, week) => {\n    const request = {\n        methodname: 'local_booking_save_slots',\n        args: {\n            slots: weekSlots,\n            courseid: course,\n            year: year,\n            week: week\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Remove all saved slots for a specific week & year\n * for the current user (student)\n *\n * @param {int} course The id of the associated course\n * @param {int} year The id of the event to update\n * @param {int} week A timestamp for some time during the target day\n * @return {promise}\n */\n export const clearSlots = (course, year, week) => {\n    const request = {\n        methodname: 'local_booking_delete_slots',\n        args: {\n            courseid: course,\n            year: year,\n            week: week\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Send the form data of the logbook entry form\n * to be persisted at the server.\n *\n * @method submitCreateUpdateLogentryForm\n * @param {string} formArgs An array of J URL encoded values from the form\n * @param {string} formData The URL encoded values from the form\n * @return {promise} Resolved with the new or edited logbook entry\n */\n export const submitCreateUpdateLogentryForm = (formArgs, formData) => {\n    const request = {\n        methodname: 'local_booking_submit_create_update_form',\n        args: {\n            formargs: formArgs,\n            formdata: formData\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Get a graded session logbook entry by id.\n *\n * @method getPilotLogbook\n * @param  {number} courseId The associated course id.\n * @param  {number} userId The user id of entry.\n * @return {promise} Resolved with requested calendar event\n */\n export const getPilotLogbook = (courseId, userId) => {\n\n    const request = {\n        methodname: 'local_booking_get_pilot_logbook',\n        args: {\n            courseid: courseId,\n            userid: userId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Get a graded session logbook entry by id.\n *\n * @method getLogentryById\n * @param {number} logentryId The logbook entry id.\n * @param {number} courseId The associated course id.\n * @param {number} userId The user id of entry.\n * @return {promise} Resolved with requested calendar event\n */\n export const getLogentryById = (logentryId, courseId, userId) => {\n\n    const request = {\n        methodname: 'local_booking_get_logentry_by_id',\n        args: {\n            logentryid: logentryId,\n            courseid: courseId,\n            userid: userId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Delete a log book entry by id.\n *\n * @method deleteLogentry\n * @param {number} logentryId The logbook entry id to delete.\n * @param {number} userId The logbook entry course id.\n * @param {number} courseId The logbook entry user id.\n * @return {promise} Resolved with requested calendar event\n */\n export const deleteLogentry = (logentryId, userId, courseId) => {\n\n    const request = {\n        methodname: 'local_booking_delete_logentry',\n        args: {\n            logentryid: logentryId,\n            userid: userId,\n            courseid: courseId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Send the form data of the logbook entry form\n * to be persisted at the server.\n *\n * @method findPirep\n * @param  {string} pirep The passed PIREP number\n * @param  {number} courseId The logbook entry user id.\n * @param  {number} userId The logbook entry course id.\n * @param  {number} exerciseId The logbook entry course id.\n * @return  {promise} Resolved with the pirep data\n */\n export const findPirep = (pirep, courseId, userId, exerciseId) => {\n    const request = {\n        methodname: 'local_booking_get_pirep',\n        args: {\n            pirep: pirep,\n            courseid: courseId,\n            userid: userId,\n            exerciseid: exerciseId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Update Suspended status from the user profile.\n *\n * @method updateSuspended\n * @param  {bool}   status   Suspended true or false.\n * @param  {number} courseId The profile user id.\n * @param  {number} userId   The profile course id.\n * @return {promise}         Resolved with suspension true/false promise\n */\n export const updateSuspendedStatus = (status, courseId, userId) => {\n    const request = {\n        methodname: 'local_booking_update_suspended_status',\n        args: {\n            status: status,\n            courseid: courseId,\n            userid: userId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Update group membership status for Onhold and Keep Active groups for the user profile.\n *\n * @method updateGroup\n * @param  {string} group    Group name.\n * @param  {bool}   ismember Membership true or false.\n * @param  {number} courseId The profile user id.\n * @param  {number} userId   The profile course id.\n * @return {promise}         Resolved with group membership true/false promise\n */\n export const updateGroup = (group, ismember, courseId, userId) => {\n    const request = {\n        methodname: 'local_booking_update_group_status',\n        args: {\n            group: group,\n            ismember: ismember,\n            courseid: courseId,\n            userid: userId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Update user preferences for restrictions override or\n * endorsement status.\n *\n * @method updateUserPreferences\n * @param  {string} preference  Preference name.\n * @param  {string} value       User preference value.\n * @param  {number} courseId    The profile user id.\n * @param  {number} userId      The profile course id.\n * @return {promise}            Resolved with preference set promise\n */\n export const updateUserPreferences = (preference, value, courseId, userId) => {\n    const request = {\n        methodname: 'local_booking_update_user_preferences',\n        args: {\n            preference: preference,\n            value: value,\n            courseid: courseId,\n            userid: userId\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n\n/**\n * Update user comment (description).\n *\n * @method updateProfileComment\n * @param  {number} courseId    The profile course id.\n * @param  {number} userId      The profile user id.\n * @param  {string} comment     Comment text.\n * @return {promise}            Resolved with preference set promise\n */\n export const updateProfileComment = (courseId, userId, comment) => {\n    const request = {\n        methodname: 'local_booking_update_profile_comment',\n        args: {\n            courseid: courseId,\n            userid: userId,\n            comment: comment\n        }\n    };\n\n    return Ajax.call([request])[0];\n};\n"],"file":"repository.min.js"}