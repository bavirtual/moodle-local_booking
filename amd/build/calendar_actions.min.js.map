{"version":3,"file":"calendar_actions.min.js","sources":["../src/calendar_actions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Contain the logic for the quick add or update event modal.\n *\n * @module     local_booking/calendar_actions\n * @author     Mustafa Hajjar (mustafa.hajjar)\n * @copyright  BAVirtual.co.uk Â© 2024\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'jquery',\n    'core/notification',\n    'local_booking/repository',\n    'local_booking/calendar_view_manager',\n    'local_booking/events',\n    'local_booking/modal_actions',\n    'local_booking/selectors',\n    ],\n    function(\n        $,\n        Notification,\n        Repository,\n        CalendarViewManager,\n        BookingEvents,\n        ModalActions,\n        Selectors,\n    ) {\n\n    var SELECTORS = {\n        LOADING_ICON_CONTAINER: '[data-region=\"loading-icon-container\"]',\n    };\n\n    var Slots = [];\n    var BookedSlots = [];\n    var SlotIndexes = [];\n    let postActive = false;\n    let formSaved = true;\n\n    /**\n     * Save marked availability posts.\n     *\n     * @method saveWeekSlots\n     * @param {object} root The calendar root element\n     * @param {event} e The calendar move event\n     * @return {object} The create modal promise\n     */\n    function saveWeekSlots(root, e = null) {\n\n        CalendarViewManager.startLoading(root);\n\n        // Get year and week\n        const course = root.find(Selectors.wrappers.calendarwrapper).data('courseid'),\n              year = root.find(Selectors.wrappers.calendarwrapper).data('year'),\n              week = root.find(Selectors.wrappers.calendarwrapper).data('week'),\n              time = root.find(Selectors.wrappers.calendarwrapper).data('time'),\n              eventData = e !== null ? e.eventData : {year, week, time, course},\n              minslotperiod = root.find(Selectors.wrappers.calendarwrapper).data('minslotperiod'),\n              unixTsHr = 3600,\n              lastMinute = 60;\n\n        // Get marked availability slots\n        getSlots(root);\n\n        // Evaluate each slot to ensure it is a minimum of 2hrs if minimum slots is required (minslotperiod!=0)\n        let minSlotPeriodMet = true;\n        $.map(Slots, function(val) {\n            if ((val.endtime - val.starttime + lastMinute) < (minslotperiod * unixTsHr) && minslotperiod != 0) {\n                minSlotPeriodMet = false;\n            }\n        });\n\n        if (minSlotPeriodMet) {\n            let serverCall = null;\n            if (Slots.length != 0) {\n                serverCall = Repository.saveSlots(Slots, course, year, week);\n            } else {\n                serverCall = Repository.clearSlots(course, year, week);\n            }\n\n            // Send a request to the server to clear slots.\n            return serverCall\n                .then(function(response) {\n                    if (response.validationerror) {\n                        // eslint-disable-next-line no-alert\n                        alert('Errors encountered: Unable to process availability posting action!');\n                    }\n                    clean();\n                    const slotsSavedEvent = $.Event(BookingEvents.slotsSaved, {'eventData': eventData});\n                    root.trigger(slotsSavedEvent, this);\n\n                    return;\n                })\n                .always(function() {\n                    Notification.fetchNotifications();\n                    return CalendarViewManager.stopLoading(root);\n                })\n                .fail(Notification.exception);\n        } else {\n            // Show warning message\n            CalendarViewManager.stopLoading(root);\n            ModalActions.showWarning('warnminslotperiod', 'warnminslotperiodtitle', minslotperiod, {fromComponent: true});\n            return false;\n        }\n    }\n\n    /**\n     * Save marked booking posts.\n     *\n     * @method saveBookedSlot\n     * @param {object} root The calendar root element\n     * @return {object} The create modal promise\n     */\n     async function saveBookedSlot(root) {\n\n        const bookButton = $(Selectors.regions.bookbutton),\n              loadingContainer = bookButton.find(SELECTORS.LOADING_ICON_CONTAINER);\n\n            loadingContainer.removeClass('hidden');\n            bookButton.prop('disabled', true);\n            CalendarViewManager.startLoading(root);\n\n            // Get exercise id and the user id from the URL\n            const course = $(Selectors.wrappers.calendarwrapper).data('courseid');\n            const exercise = $(Selectors.wrappers.calendarwrapper).data('exercise-id');\n            const studentid = $(Selectors.wrappers.calendarwrapper).data('student-id');\n\n            // Get marked availability slots\n            getSlots(root, 'book');\n\n            // Check if the instructor has conflicting bookings\n            let hasConflictingBooking = await Repository.hasConflictingBooking(studentid, BookedSlots[0])\n                .then(function(response) {\n                    if (response.validationerror) {\n                        // eslint-disable-next-line no-alert\n                        alert('Errors encountered: Unable to check conflicting bookings!');\n                        CalendarViewManager.stopLoading(root);\n                    } else {\n                        // Check if there are no conflicting messages\n                        if (response.result) {\n                            ModalActions.showWarning(response.warnings[0].message, 'Warning');\n                            CalendarViewManager.stopLoading(root);\n                            loadingContainer.addClass('hidden');\n                            bookButton.prop('disabled', false);\n                        }\n                    }\n                    return response.result;\n                })\n                .fail(Notification.exception);\n\n            // Save booking if no conflicting bookings were found\n            if (!hasConflictingBooking) {\n                Repository.saveBookedSlot(BookedSlots[0], course, exercise, studentid)\n                .then(function(response) {\n                    if (response.validationerror) {\n                        // eslint-disable-next-line no-alert\n                        alert('Errors encountered: Unable to save slot!');\n                        CalendarViewManager.stopLoading(root);\n                    } else {\n                        clean();\n                        // Redirect to bookings view\n                        location.href = M.cfg.wwwroot + '/local/booking/view.php?courseid=' + course;\n                    }\n                    return;\n                })\n                .fail(Notification.exception);\n            }\n        }\n\n    /**\n     * Update Slots & BookedSlots with marked availability\n     * posts in the calendar view.\n     *\n     * @method getSlots\n     * @param {object} root     The calendar root element\n     * @param {String} action   The action for display view/book\n     */\n    function getSlots(root, action) {\n\n        const slotType = action == 'book' ? 'slot-booked' : 'slot-marked';\n        const year = $(Selectors.wrappers.calendarwrapper).data('year');\n        const week = $(Selectors.wrappers.calendarwrapper).data('week');\n        const minute59 = 3540; // 59 minutes end of slot but before next hour\n\n        const tableId = $(Selectors.regions.slotsweek).attr('id');\n        const head = $('#' + tableId + ' th');\n        const colCount = document.getElementById(tableId).rows[0].cells.length;\n        var colOffset;\n\n        Slots.length = 0;\n        BookedSlots.length = 0;\n\n        // Get column index for the start of the week\n        head.each(function() {\n            if ($(this).data('region') == 'slot-week-day') {\n                colOffset = head.index(this) + 1;\n                return false;\n            }\n            return true;\n        });\n\n        // Get all slots for this week from the UI table\n        for (let i = colOffset; i <= colCount; i++) {\n            // Get slots for the current day: [slottype, slottimestamp, bookable]\n            const dayHour = $('#' + tableId + ' td:nth-child(' + i + ')').map(function() {\n                return [[$(this).data(slotType), $(this).data('slot-timestamp'), $(this).data('slot-status')]];\n            }).get();\n\n            // Get each slot in the day (start and end times)\n            let aSlot = {};\n\n            // Check each day (column) and record marked slot start-end times\n            dayHour.forEach((hourSlot, index) => {\n                let isLastElement = index == dayHour.length - 1;\n                let bookable = hourSlot[2] != 'tentative'; // Already booked slots are not bookable\n\n                // Check if the slot is marked to record start or end time in marked sequence, and bookable\n                if (hourSlot[0] && bookable) {\n                    if (Object.keys(aSlot).length === 0 && aSlot.constructor === Object) {\n                        aSlot.starttime = hourSlot[1];\n                        aSlot.endtime = hourSlot[1] + minute59;\n                    } else {\n                        aSlot.endtime = hourSlot[1] + minute59;\n                    }\n\n                // Add the slot if it has start and end, and this slot is empty => slot sequence ended, and bookable\n                } else if (!(Object.keys(aSlot).length === 0 && aSlot.constructor === Object) && bookable) {\n                    aSlot = addSlot(aSlot, slotType, week, year);\n                }\n\n                // Add slot if it ends at the end of the day, edge case handling, and slot status is empty (bookable)\n                if (isLastElement && !(Object.keys(aSlot).length === 0 && aSlot.constructor === Object) && bookable) {\n                    aSlot = addSlot(aSlot, slotType, week, year);\n                }\n            });\n        }\n    }\n\n    /**\n     * Adds a slot to local object array (Slots).\n     *\n     * @method addSlot\n     * @param {object} aSlot The slot to be add to the local object array\n     * @param {string} slotType The slot type availability post vs booked\n     * @param {int} week The week of the year\n     * @param {int} year The year\n     * @return {object} empty object\n     */\n     function addSlot(aSlot, slotType, week = 0, year = 0) {\n        if (slotType == 'slot-marked') {\n            Slots.push(aSlot);\n        } else if (slotType == 'slot-booked') {\n            aSlot.week = week;\n            aSlot.year = year;\n            BookedSlots.push(aSlot);\n        }\n        return {};\n    }\n\n    /**\n     * Update the indexes array tracking copied table indexes\n     * editing existing events.\n     *\n     * @param {object} root The calendar root element\n     * @method copySlots\n     */\n    function copySlots(root) {\n        SlotIndexes.length = 0;\n\n        $(Selectors.regions.day).each((idx, el) => {\n            if ($(el).data('slot-marked')) {\n                SlotIndexes.push([el.closest('tr').rowIndex, el.cellIndex]);\n            }\n        });\n\n        setPasteState(root);\n\n        return;\n    }\n\n    /**\n     * Paste slots by setting the cells from\n     * SlotIndexes (copied cells) to the calendar\n     *\n     * @method pasteSlots\n     * @param {object} root The calendar root element\n     */\n    function pasteSlots(root) {\n        if (SlotIndexes.length > 0) {\n            const table = document.getElementById(root.find(Selectors.regions.slotsweek).attr('id'));\n            SlotIndexes.forEach((idx) => {\n                let slot = table.rows[idx[0]].cells[idx[1]];\n                if (!$(slot).hasClass(\"slot-unavailable\")) {\n                    $(slot).data('slot-marked', 1);\n                    $(slot).addClass('slot-selected', 1);\n                }\n            });\n            formSaved = false;\n        }\n\n        return;\n     }\n\n    /**\n     * Clear slots for a user per course in week and year\n     * given they are not otherwise booked\n     *\n     * @method clearWeekSlots\n     */\n    function clearWeekSlots() {\n        $('td').filter(function() {\n            if ($(this).data('slot-booked') == 0) {\n                $(this).data('slot-marked', 0);\n                $(this).removeClass('slot-selected');\n            }\n            return true;\n        });\n        formSaved = false;\n        return;\n    }\n\n    /**\n     * Set the cells from the copied SlotIndexes to the current table\n     *\n     * @method setPasteState\n     * @param {object} root The week calendar root element\n     */\n    function setPasteState(root) {\n        if (SlotIndexes.length > 0) {\n            root.find(Selectors.regions.pastebutton).addClass('btn-primary').removeClass('btn-secondary');\n        } else {\n            root.find(Selectors.regions.pastebutton).addClass('btn-secondary').removeClass('btn-primary');\n        }\n\n        return;\n     }\n\n    /**\n     * Set the cells from the CopiedSlotsIndexes to the current table\n     *\n     * @method setSlot\n     * @param {object} cell     The copied cell\n     * @param {String} action   The action mode: book|post\n     */\n    function setSlot(cell, action) {\n        const slotAction = action == 'book' ? 'slot-booked' : 'slot-marked';\n        const slotActionClass = action == 'book' ? 'slot-booked' : 'slot-selected';\n\n        if (!$(cell).data(slotAction)) {\n            $(cell).addClass(slotActionClass);\n        } else {\n            $(cell).removeClass(slotActionClass);\n        }\n        $(cell).data(slotAction, !$(cell).data(slotAction));\n\n        return;\n    }\n\n    /**\n     * Set cells selected and save buttons state\n     *\n     * @method setPosting\n     * @param {bool} state  The posting state\n     */\n    function setPosting(state) {\n        postActive = state;\n    }\n\n    /**\n     * Set cells selected and save buttons state\n     *\n     * @method postSlots\n     * @param {object} root     The calendar root element\n     * @param {String} action   The action behind the active view\n     * @param {object} target   The target event object (cell)\n     * @param {String} overridePost The override flag for posting state\n     */\n    function postSlots(root, action, target, overridePost = false) {\n        // Change marked state\n        if (typeof target !== 'undefined' && (postActive || overridePost) &&\n            !target.is(Selectors.regions.daytimeslot) && action !== 'all' && action !== '') {\n                formSaved = false;\n                setSlot(target, action);\n        }\n    }\n\n    /**\n     * Checks whether the calendar has been edited without saving\n     *\n     * @method isDirty\n     * @return {bool} dirtyState  The posting state\n     */\n    function isDirty() {\n        return !formSaved;\n    }\n\n    /**\n     * Reset the form saved flag so the form is no longer dirty\n     *\n     * @method clean\n     * @return {bool} dirtyState  The posting state\n     */\n    function clean() {\n        formSaved = true;\n    }\n\n    return {\n        saveWeekSlots: saveWeekSlots,\n        saveBookedSlot: saveBookedSlot,\n        clearWeekSlots: clearWeekSlots,\n        pasteSlots: pasteSlots,\n        setPasteState: setPasteState,\n        copySlots: copySlots,\n        postSlots: postSlots,\n        setPosting: setPosting,\n        isDirty: isDirty,\n        clean: clean,\n        Slots: Slots,\n        SlotIndexes: SlotIndexes\n    };\n});"],"names":["define","$","Notification","Repository","CalendarViewManager","BookingEvents","ModalActions","Selectors","SELECTORS","Slots","BookedSlots","SlotIndexes","postActive","formSaved","getSlots","root","action","slotType","year","wrappers","calendarwrapper","data","week","tableId","regions","slotsweek","attr","head","colCount","document","getElementById","rows","cells","length","colOffset","each","this","index","i","dayHour","map","get","aSlot","forEach","hourSlot","isLastElement","bookable","Object","keys","constructor","starttime","endtime","addSlot","push","setPasteState","find","pastebutton","addClass","removeClass","setSlot","cell","slotAction","slotActionClass","clean","saveWeekSlots","e","startLoading","course","time","eventData","minslotperiod","unixTsHr","lastMinute","minSlotPeriodMet","val","serverCall","saveSlots","clearSlots","then","response","validationerror","alert","slotsSavedEvent","Event","slotsSaved","trigger","always","fetchNotifications","stopLoading","fail","exception","showWarning","fromComponent","saveBookedSlot","bookButton","bookbutton","loadingContainer","prop","exercise","studentid","hasConflictingBooking","result","warnings","message","location","href","M","cfg","wwwroot","clearWeekSlots","filter","pasteSlots","table","idx","slot","hasClass","copySlots","day","el","closest","rowIndex","cellIndex","postSlots","target","overridePost","is","daytimeslot","setPosting","state","isDirty"],"mappings":"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"}