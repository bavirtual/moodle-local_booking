define ("local_booking/booking",["jquery","core/str","core/pending","core/modal_factory","local_booking/booking_view_manager","local_booking/booking_actions","local_booking/events","local_booking/modal_logentry_form","local_booking/selectors"],function(a,b,c,d,f,g,h,i,j){var k={CANCEL_BUTTON:"[data-region='cancel-button']",OVERRIDE_BUTTON:"[data-region='override-button']"},l=function(c){var d=a("body");d.on(h.canceled,function(){f.refreshInstructorDashboardContent(c);f.refreshMyBookingsContent(c)});d.on(h.created,function(){f.refreshInstructorDashboardContent(c)});d.on(h.updated,function(){f.refreshInstructorDashboardContent(c)});d.on(h.deleted,function(){f.refreshInstructorDashboardContent(c)});g.registerRedirect(c);c.on("click",k.CANCEL_BUTTON,function(a){b.get_string("cancellationcomment","local_booking").then(function(b){var d=prompt(b);if(null!==d){g.cancelBooking(c,a,d)}}).catch(Notification.exception)});c.on("click",k.OVERRIDE_BUTTON,function(){return g.overrideRestriction(c)})},m=function(b){var c=a(j.bookingwrapper).data("contextid"),d=a(j.bookingwrapper).data("courseid");if(c){b.on("click",j.actions.viewLogEntry,function(b){var e=a(this).attr("data-logentry-id"),f=a(this).attr("data-student-id");b.preventDefault();b.stopPropagation();if(0==e){n(null,b,c,d,f,e,!0)}else{o(c,d,f,e)}b.stopImmediatePropagation()})}},n=function(a,b,e,g,h,j,k){var l=d.create({type:i.TYPE,large:!0}),m=b.target,n=new c("local_booking/registerLogentryEditForm");f.renderLogentryModal(a,b,l,m,e,g,h,j,k).then(n.resolve()).catch()},o=function(b,d,e,g){var i=new c("local_booking/registerLogentrySummaryForm");if(g){f.renderLogentrySummaryModal(d,e,g).then(function(c){a("body").on(h.editLogentry,function(a,e,f){n(c.getRoot(),a,b,d,e,f);a.stopImmediatePropagation()});a("body").on(h.addLogentry,function(a,e){n(c.getRoot(),a,b,d,e,0);a.stopImmediatePropagation()});return c}).then(i.resolve()).catch()}else{i.resolve()}},p=function(a){l(a);m(a)};return{init:function init(b){b=a(b);p(b)}}});
//# sourceMappingURL=booking.min.js.map
