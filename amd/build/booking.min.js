define ("local_booking/booking",["jquery","core/str","core/modal_factory","core/modal_events","core/pending","local_booking/modal_logentry_form","local_booking/booking_view_manager","local_booking/booking_actions","local_booking/events","local_booking/selectors"],function(a,b,c,d,f,g,h,i,j,k){var l={BOOKING_WRAPPER:".bookingwrapper",CANCEL_BUTTON:"[data-region='cancel-button']",OVERRIDE_BUTTON:"[data-region='override-button']",SESSION_ENTRY:"[data-region='session-entry']"},m=function(b,c){var d=a("body");d.on(j.canceled,function(){h.refreshProgressionContent(b);h.refreshMyBookingsContent(b)});d.on(j.created,function(){h.refreshProgressionContent(b)});d.on(j.updated,function(){h.refreshProgressionContent(b)});d.on(j.deleted,function(){h.refreshProgressionContent(b)});i.registerActionListeners(b,c)},n=function(c){var d=i.registerLogentryFormModal(c),e=a(l.BOOKING_WRAPPER).data("contextid"),g=a(l.BOOKING_WRAPPER).data("courseid");m(c,d);if(e){c.on("click",l.SESSION_ENTRY,function(b){var c=a(this).attr("data-session-date"),i=a(this).attr("data-student-id"),j=a(this).attr("data-exercise-id"),l=a(this).attr("data-logentry-id"),m=a(this).attr("data-is-additional")!==void 0;if(0==l){d.then(function(a){a.setContextId(e);a.setCourseId(g);a.setStudentId(i);a.setExerciseId(j);a.setLogentryId(l);a.setSessionDate(c);a.setAdditionalEntry(m);a.show()}).fail(Notification.exception);b.preventDefault()}else{var n=null,o=null,p=b.target,q=new f("local_booking/booking_view_manager:logentrySession:click");if(p.matches(k.actions.viewLogEntry)){n=p}else{n=p.closest(k.actions.viewLogEntry)}if(n){o=n.dataset.logentryId}else{o=p.querySelector(k.actions.viewLogEntry).dataset.logentryId}if(o){b.preventDefault();b.stopPropagation();h.renderLogentrySummaryModal(o,g,i).then(q.resolve).catch()}else{q.resolve()}}})}c.on("click",l.CANCEL_BUTTON,function(a){b.get_string("cancellationcomment","local_booking").then(function(b){var d=prompt(b);if(null!==d){i.cancelBooking(c,a,d)}}).catch(Notification.exception)});c.on("click",l.OVERRIDE_BUTTON,function(){return i.overrideRestriction(c)})};return{init:function init(b){b=a(b);n(b)}}});
//# sourceMappingURL=booking.min.js.map
