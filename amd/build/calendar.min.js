/**
 * This module is the highest level module for the calendar. It is
 * responsible for initialising all of the components required for
 * the calendar to run. It also coordinates the interaction between
 * components by listening for and responding to different events
 * triggered within the calendar UI.
 *
 *  Improvised from core_calendar.
 *
 * @module     local_booking/calendar
 * @author     Mustafa Hajjar (mustafa.hajjar)
 * @copyright  BAVirtual.co.uk Â© 2022
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_booking/calendar",["jquery","local_booking/calendar_view_manager","local_booking/slot_actions","local_booking/events","local_booking/selectors"],(function($,CalendarViewManager,SlotActions,ModalEvents,Selectors){const beforeUnloadHandler=e=>SlotActions.isDirty()?e.preventDefault():(window.removeEventListener("beforeunload",beforeUnloadHandler),null);return{init:function(root){root=$(root),CalendarViewManager.startLoading(root),function(root){const action=root.find(Selectors.wrappers.calendarwrapper).data("action"),warningModal=$("body");root.on("click",Selectors.links.navLink,(e=>{const courseId=root.find(Selectors.wrappers.calendarwrapper).data("courseid"),link=e.currentTarget;e.preventDefault(),CalendarViewManager.changeWeek(root,link.href,link.dataset.year,link.dataset.week,link.dataset.time,courseId)})),warningModal.on(ModalEvents.yesEvent,(function(e){const courseId=root.find(Selectors.wrappers.calendarwrapper).data("courseid"),link=e.eventData;"book"==action?SlotActions.saveBookedSlot(root):SlotActions.saveWeekSlots(root),CalendarViewManager.changeWeek(root,link.url,link.year,link.week,link.time,courseId)})),root.on("click",Selectors.regions.savebutton,(function(){SlotActions.saveWeekSlots(root)})),root.on("click",Selectors.regions.bookbutton,(function(){SlotActions.saveBookedSlot(root)})),root.on("click",Selectors.regions.copybutton,(function(){SlotActions.copySlots(root)})),root.on("click",Selectors.regions.pastebutton,(function(){SlotActions.pasteSlots(root)})),root.on("click",Selectors.regions.clearbutton,(function(){SlotActions.clearWeekSlots()})),root.on("mousedown",Selectors.regions.day,(function(e){SlotActions.setPosting(!0),SlotActions.postSlots(root,action,$(e.target)),e.preventDefault()})),root.on("mouseover",Selectors.regions.day,(function(e){SlotActions.postSlots(root,action,$(e.target)),e.preventDefault()})),root.on("mouseup",Selectors.regions.day,(function(){SlotActions.setPosting(!1)})),window.addEventListener("beforeunload",beforeUnloadHandler),root.find(Selectors.containers.loadingIcon).addClass("hidden")}(root),CalendarViewManager.stopLoading(root)}}}));

//# sourceMappingURL=calendar.min.js.map