define ("local_booking/booking",["jquery","core/str","core/pending","core/modal_factory","local_booking/booking_view_manager","local_booking/booking_actions","local_booking/events","local_booking/modal_logentry_form","local_booking/selectors"],function(a,b,c,d,f,g,h,i,j){var k=function(c){var d=a("body");d.on(h.canceled,function(){f.refreshBookingsContent(c);f.refreshMyBookingsContent(c)});d.on(h.created,function(){f.refreshBookingsContent(c)});d.on(h.updated,function(){f.refreshBookingsContent(c)});d.on(h.deleted,function(){f.refreshBookingsContent(c)});c.on("click",j.cancelbutton,function(a){b.get_string("cancellationcomment","local_booking").then(function(b){var d=prompt(b);if(null!==d){g.cancelBooking(c,a,d)}}).catch(Notification.exception)});c.on("change","input[type=radio][name=studentsfilter]",function(){f.refreshBookingsContent(c,0,0,null,a("input[name=\"studentsfilter\"]:checked").val())});c.on("click",j.actions.gotoFeedback,function(a){g.gotoFeedback(c,a);a.preventDefault()})},l=function(b){var c=a(j.bookingwrapper).data("contextid"),d=a(j.bookingwrapper).data("courseid");if(c){b.on("click",j.actions.viewLogEntry,function(b){var e=a(this).attr("data-logentry-id"),f=a(this).attr("data-student-id");b.preventDefault();b.stopPropagation();if(0==e){m(null,b,c,d,f,e,!0)}else{n(c,d,f,e)}b.stopImmediatePropagation()})}},m=function(a,b,e,g,h,j,k){var l=d.create({type:i.TYPE,large:!0}),m=b.target,n=new c("local_booking/registerLogentryEditForm");f.renderLogentryModal(a,b,l,m,e,g,h,j,k).then(n.resolve()).catch()},n=function(b,d,e,g){var i=new c("local_booking/registerLogentrySummaryForm");if(g){f.renderLogentrySummaryModal(d,e,g).then(function(c){a("body").on(h.editLogentry,function(a,e,f){m(c.getRoot(),a,b,d,e,f);a.stopImmediatePropagation()});a("body").on(h.addLogentry,function(a,e){m(c.getRoot(),a,b,d,e,0);a.stopImmediatePropagation()});return c}).then(i.resolve()).catch()}else{i.resolve()}},o=function(a){k(a);l(a)};return{init:function init(b){var b=a(b);o(b);f.stopLoading(b)}}});
//# sourceMappingURL=booking.min.js.map
